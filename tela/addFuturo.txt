                        [Controller]:

//Altera Senha
const alterarSenha = async (req, res) => {
  const { id, passwordAtual, newPassword } = req.body;

  console.log("Id recebido:", id);

  if (!id || !passwordAtual || !newPassword) {
    return res.status(400).json({ message: 'Todos os campos são obrigatórios' });
  }

  try {
    const resultado = await userService.alterarSenha(id, passwordAtual, newPassword);
    res.status(200).json(resultado);
  } catch (error) {
    res.status(400).json({ message: error.message });
  }
};


//Deletar Usuario
const deletarUsuario = async (req, res) => {
  const { id } = req.body;

  if (!id) {
    return res.status(400).json({ message: 'ID do Usuario e Obrigatorio' });
  }

  try {
    const sucesso = await userService.deletarUsuario(id);
    if (sucesso) {
      res.status(200).json({ message: 'Usuario deletado com Sucesso' });
    } else {
      res.status(404).json({ message: 'Usuario nao encontrado' });
    }
  } catch (error) {
    res.status(500).json({ message: 'Erro ao deletar usúario', error: error.message });
  }
}

module.exports = {
    cadastro,
    login,
    alterarSenha,
    deletarUsuario,
    salvarVelocidade
}




                        [Service]:

//Logica do NovaSenha
const alterarSenha = async (id, passwordAtual, newPassword) => {
    const [rows] = await db.query('SELECT * FROM usuarios WHERE id = ?', [id]);
    const user = rows[0];

    if (!user) {
        throw new Error('Usuário não encontrado');
    }

    const passwordCorreta = await bcrypt.compare(passwordAtual, user.password);
    if (!passwordCorreta) {
        throw new Error('Senha atual incorreta');
    }

    const newPasswordHash = await bcrypt.hash(newPassword, 20);
    await db.query('UPDATE usuarios SET password = ? WHERE id = ?', [newPasswordHash, id]);

    return { message: 'Senha alterada com sucesso' };
}

//Logica do Deletar Usuario
const deletarUsuario = async (id) => {
    const [result] = await db.query('DELETE FROM usuarios WHERE id = ?', [id]);
    return result.affectedRows > 0;
}

module.exports = {
    cadastroUser,
    loginUser,
    alterarSenha,
    deletarUsuario,
    salvarVelocidadeMoto
}